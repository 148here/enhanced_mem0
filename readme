1. 项目介绍请参考论文文件。代码基于https://github.com/mem0ai/mem0。
2. 安装依赖
2.1 安装依赖包
(可选)conda create -n enhanced_mem0 python=3.10
(可选)conda activate enhanced_mem0
git clone https://github.com/148here/enhanced_mem0.git
pip install -r requirements.txt

2.2 （可选）启用图数据库服务
利用docker启用数据库服务，运行后自动下载镜像并启用；可用其他数据库替代，示例代码如下：
docker run -d --name mem0-neo4j -p 7474:7474 -p 7687:7687 -e NEO4J_AUTH=neo4j/password neo4j:5
若不启用，则需要在运行时配置关闭图服务

2.3 配置apikey
在./.env文件中配置apikey，示例代码如下：

# OpenAI API key for GPT models and embeddings (其他兼容openai的api key均可，示例使用qwen-plus)
OPENAI_API_KEY="YOUR_API_KEY"
OPENAI_BASE_URL="https://dashscope.aliyuncs.com/compatible-mode/v1"
OPENAI_MODEL="qwen-plus"

# Model configuration
MODEL="qwen-plus"  # or your preferred model
EMBEDDING_MODEL="text-embedding-v4"  # or your preferred embedding model
ZEP_API_KEY=""

# 本地向量库（默认 faiss）
MEM0_VECTOR_STORE_PROVIDER=faiss
MEM0_VECTOR_STORE_PATH=results/faiss
MEM0_COLLECTION=locomo_eval
MEM0_EMBEDDING_DIMS=1536

# 记忆抽取/更新用的 LLM（可以和 MODEL 不同）
MEM0_MEMORY_LLM_MODEL="qwen-plus"

# is_graph=True 时 Neo4j 配置
NEO4J_URL=neo4j://localhost:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=password

然后把这个.env文件复制到mem0/evaluation/.env文件中

3. 运行enhanced_mem0评测：
cd enhanced_mem0/mem0/evaluation

3.1 写入记忆：
python run experiments.py \
--technique_type mem0 \
--method add \
--is_graph \
--max_conversations 2 #locomo数据集中的评测conversation数 可填1-10 可选更大，但耗时更长（同api最大并行数目有限制）

3.2 检索+回答
python run_experiments.py \
--technique_type mem0 \
--method search \
--is_graph \
--output_folder results/ \
--top_k 16 \
--max_conversations 2 \ # 和写入保持一致
--sample_rate 1 \ # 加速trick，当问题id%sample_rate==0时才检索。设为1时等价于全部检索
--num_candidates 1 \ # 裁判模型候选答案数量 设为1时取消裁判模型
--max_expand_rounds 2 \ # 裁判模型最多扩展轮次

3.3 运行评测
python evals.py \
--input_file PATH_TO_YOUR_RESULTS.JSON \ # default result of 3.2 will be in ./results/
--output_file PATH_TO_YOUR_OURPUT_PATH

4. 运行webUI，进行实时对话体验
cd enhanced_mem0/
python chat_webui.py
在浏览器中打开http://127.0.0.1:7860，根据ui自行体验: 可互动对话、切换窗口、查看输入输出的debug信息以更清晰地了解流程。

默认本地记忆数据库.faiss和.pkl文件会保存到enhanced_mem0/results/faiss/，可以根据.env文件中的MEM0_VECTOR_STORE_PATH覆盖。可以手动清空用户数据库，或者手动指定不同用户数据库；
不同聊天窗口内历史不共享，但记忆数据库信息共享。
